<!DOCTYPE html>
<html>
<head>
<title>Contact Sam Cruise: Routine at 80F2</title>
<meta charset="utf-8" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body class="save-Asm-c">
<table class="header">
<tr>
<td class="logo"><a href="../index.html"><img alt="Contact Sam Cruise" src="../images/logo.png" /></a></td>
<td class="page-header">Save routine</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
</td>
<td class="up">Up: <a href="save.html#80f2">Map</a></td>
<td class="next">
</td>
</tr>
</table>
<div class="description">80F2: Save Contact Sam Cruise to tape</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="5">
<div class="details">
<div class="paragraph">
<table class="">
<tr>
<td class="" colspan="1" rowspan="1"><img alt="saver" src="../images/scr/saver.png" /></td>
<td class="" colspan="1" rowspan="1">This is the program used to save the standard speed code block for Contact Sam Cruise.</td>
</tr>
</table>
</div>
<div class="paragraph">
The standard speed code block consists of two sections of data. The first section contains the 16572 bytes of data for addresses 4000-80BB. The second section contains 32892 bytes of data starting at address 80D0, moving forward in steps of 247 bytes (rolling back to page 0x7F every time the 64K boundary is reached), and ending at 817D.
</div>
<div class="paragraph">
Note that the second section does not contain data for addresses 8274-FFE2 (step 247); these addresses are filled in by the routine at <a href="../load/8116.html">8116</a> after the fast code block has loaded. Also note that although the byte for address 817D is saved to tape, it is not loaded by the <a href="../load/802F.html">load routine</a>; instead, it is also filled in by the routine at <a href="../load/8116.html">8116</a>.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="80f2"></span>80F2</td>
<td class="instruction">LD SP,$5CFE</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="80f5"></span>80F5</td>
<td class="instruction">LD HL,$81C8</td>
<td class="comment-1" rowspan="1"><a href="../start/81C8.html">81C8</a> is where the game starts after loading</td>
</tr>
<tr>
<td class="address-1"><span id="80f8"></span>80F8</td>
<td class="instruction">LD ($5D1B),HL</td>
<td class="comment-1" rowspan="1">Store this address where it will be popped off the stack by the <a href="../load/802F.html">load routine</a></td>
</tr>
<tr>
<td class="address-1"><span id="80fb"></span>80FB</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="3">Prepare <span class="register">BC'</span> for saving the second section of data</td>
</tr>
<tr>
<td class="address-1"><span id="80fc"></span>80FC</td>
<td class="instruction">LD BC,$00F7</td>
</tr>
<tr>
<td class="address-1"><span id="80ff"></span>80FF</td>
<td class="instruction">EXX</td>
</tr>
<tr>
<td class="address-1"><span id="8100"></span>8100</td>
<td class="instruction">LD IX,$4000</td>
<td class="comment-1" rowspan="2">4000 to 80BB will be saved first</td>
</tr>
<tr>
<td class="address-1"><span id="8104"></span>8104</td>
<td class="instruction">LD DE,$40BB</td>
</tr>
<tr>
<td class="address-1"><span id="8107"></span>8107</td>
<td class="instruction">LD A,$FF</td>
<td class="comment-1" rowspan="1">A flag byte of 0xFF (the first byte saved) indicates a data block</td>
</tr>
<tr>
<td class="address-1"><span id="8109"></span>8109</td>
<td class="instruction">LD HL,$0C98</td>
<td class="comment-1" rowspan="1">This constant will give a leader tone of about 2 seconds</td>
</tr>
<tr>
<td class="address-1"><span id="810c"></span>810C</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="810d"></span>810D</td>
<td class="instruction">INC DE</td>
<td class="comment-1" rowspan="2">Adjust the length and start address to allow for the flag byte</td>
</tr>
<tr>
<td class="address-1"><span id="810e"></span>810E</td>
<td class="instruction">DEC IX</td>
</tr>
<tr>
<td class="address-1"><span id="8110"></span>8110</td>
<td class="instruction">DI</td>
<td class="comment-1" rowspan="1">Disable interrupts</td>
</tr>
<tr>
<td class="address-1"><span id="8111"></span>8111</td>
<td class="instruction">LD A,$02</td>
<td class="comment-1" rowspan="1">MIC on, border red</td>
</tr>
<tr>
<td class="address-1"><span id="8113"></span>8113</td>
<td class="instruction">LD B,A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="8114"></span>
<div class="comments">
<div class="paragraph">
First create the 2-second leader tone.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="8114"></span>8114</td>
<td class="instruction">DJNZ $8114</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="8116"></span>8116</td>
<td class="instruction">OUT ($FE),A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="8118"></span>8118</td>
<td class="instruction">XOR $0F</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="811a"></span>811A</td>
<td class="instruction">LD B,$A4</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="811c"></span>811C</td>
<td class="instruction">DEC L</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="811d"></span>811D</td>
<td class="instruction">JR NZ,$8114</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="811f"></span>811F</td>
<td class="instruction">DEC B</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="8120"></span>8120</td>
<td class="instruction">DEC H</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="8121"></span>8121</td>
<td class="instruction">JP P,$8114</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="8124"></span>
<div class="comments">
<div class="paragraph">
Then create the sync pulse.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="8124"></span>8124</td>
<td class="instruction">LD B,$2F</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-2"><span id="8126"></span>8126</td>
<td class="instruction">DJNZ $8126</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="8128"></span>8128</td>
<td class="instruction">OUT ($FE),A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="812a"></span>812A</td>
<td class="instruction">LD A,$0D</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="812c"></span>812C</td>
<td class="instruction">LD B,$37</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-2"><span id="812e"></span>812E</td>
<td class="instruction">DJNZ $812E</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="8130"></span>8130</td>
<td class="instruction">OUT ($FE),A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="8132"></span>
<div class="comments">
<div class="paragraph">
It's time to save the first byte, which will be the flag byte (0xFF).
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="8132"></span>8132</td>
<td class="instruction">LD BC,$3B0E</td>
<td class="comment-1" rowspan="1"><span class="register">B</span>=0x3B (timing constant), <span class="register">C</span>=0x0E (MIC off, border yellow)</td>
</tr>
<tr>
<td class="address-1"><span id="8135"></span>8135</td>
<td class="instruction">EX AF,AF'</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=0xFF</td>
</tr>
<tr>
<td class="address-1"><span id="8136"></span>8136</td>
<td class="instruction">LD L,A</td>
<td class="comment-1" rowspan="1"><span class="register">L</span>=0xFF</td>
</tr>
<tr>
<td class="address-1"><span id="8137"></span>8137</td>
<td class="instruction">JP $8143</td>
<td class="comment-1" rowspan="1">Jump forward to save the flag byte</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="813a"></span>
<div class="comments">
<div class="paragraph">
This is the main byte-saving loop.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="813a"></span>813A</td>
<td class="instruction">LD A,D</td>
<td class="comment-1" rowspan="2">In the analagous ROM routine, the second instruction here is 'OR E', to check whether it's time to save the last byte (the parity byte)</td>
</tr>
<tr>
<td class="address-1"><span id="813b"></span>813B</td>
<td class="instruction">LD A,D</td>
</tr>
<tr>
<td class="address-1"><span id="813c"></span>813C</td>
<td class="instruction">JR Z,$814A</td>
<td class="comment-1" rowspan="1">This jump (to save the parity byte) is never made</td>
</tr>
<tr>
<td class="address-1"><span id="813e"></span>813E</td>
<td class="instruction">LD L,(IX+$00)</td>
<td class="comment-1" rowspan="1">Fetch the next byte to be saved</td>
</tr>
<tr>
<td class="address-2"><span id="8141"></span>8141</td>
<td class="instruction">LD A,H</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=current parity byte</td>
</tr>
<tr>
<td class="address-1"><span id="8142"></span>8142</td>
<td class="instruction">XOR L</td>
<td class="comment-1" rowspan="1">Update this for the next byte to be saved</td>
</tr>
<tr>
<td class="address-2"><span id="8143"></span>8143</td>
<td class="instruction">LD H,A</td>
<td class="comment-1" rowspan="1"><span class="register">H</span>=new parity byte</td>
</tr>
<tr>
<td class="address-1"><span id="8144"></span>8144</td>
<td class="instruction">LD A,$01</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=0x01 (MIC on, border blue)</td>
</tr>
<tr>
<td class="address-1"><span id="8146"></span>8146</td>
<td class="instruction">SCF</td>
<td class="comment-1" rowspan="1">Set the carry flag (which will act as the marker bit)</td>
</tr>
<tr>
<td class="address-1"><span id="8147"></span>8147</td>
<td class="instruction">JP $8161</td>
<td class="comment-1" rowspan="1">Jump forward to save the byte</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="814a"></span>
<div class="comments">
<div class="paragraph">
This section of code, if it were used, would save the parity byte.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="814a"></span>814A</td>
<td class="instruction">LD L,H</td>
<td class="comment-1" rowspan="1">Pick up the parity byte in <span class="register">L</span></td>
</tr>
<tr>
<td class="address-1"><span id="814b"></span>814B</td>
<td class="instruction">JR $8141</td>
<td class="comment-1" rowspan="1">Save it</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="814d"></span>
<div class="comments">
<div class="paragraph">
This is the bit-saving loop for the first section of data (4000-80BB).
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="814d"></span>814D</td>
<td class="instruction">LD A,C</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=0x0E (MIC off, border yellow) for the second pass</td>
</tr>
<tr>
<td class="address-1"><span id="814e"></span>814E</td>
<td class="instruction">BIT 7,B</td>
<td class="comment-1" rowspan="1">Set the zero flag to indicate that this is the second pass through the loop</td>
</tr>
<tr>
<td class="address-2"><span id="8150"></span>8150</td>
<td class="instruction">DJNZ $8150</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="8152"></span>8152</td>
<td class="instruction">JR NC,$8158</td>
<td class="comment-1" rowspan="1">Jump if we are saving a '0'</td>
</tr>
<tr>
<td class="address-1"><span id="8154"></span>8154</td>
<td class="instruction">LD B,$42</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-2"><span id="8156"></span>8156</td>
<td class="instruction">DJNZ $8156</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-2"><span id="8158"></span>8158</td>
<td class="instruction">OUT ($FE),A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="815a"></span>815A</td>
<td class="instruction">LD B,$3E</td>
<td class="comment-1" rowspan="1">Set the timing constant for the second pass</td>
</tr>
<tr>
<td class="address-1"><span id="815c"></span>815C</td>
<td class="instruction">JR NZ,$814D</td>
<td class="comment-1" rowspan="1">Jump back for the second pass if we've just done the first</td>
</tr>
<tr>
<td class="address-1"><span id="815e"></span>815E</td>
<td class="instruction">DEC B</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="815f"></span>815F</td>
<td class="instruction">XOR A</td>
<td class="comment-1" rowspan="1">Clear the carry flag</td>
</tr>
<tr>
<td class="address-1"><span id="8160"></span>8160</td>
<td class="instruction">INC A</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=0x01 (MIC on, border blue)</td>
</tr>
<tr>
<td class="address-2"><span id="8161"></span>8161</td>
<td class="instruction">RL L</td>
<td class="comment-1" rowspan="1">Move the bit to be saved into the carry flag, and the marker bit leftwards</td>
</tr>
<tr>
<td class="address-1"><span id="8163"></span>8163</td>
<td class="instruction">JP NZ,$8150</td>
<td class="comment-1" rowspan="1">Jump unless we've saved all 8 bits of the byte</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="8166"></span>
<div class="comments">
<div class="paragraph">
A byte from the first section (4000-80BB) has just been saved. Are there any more left?
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="8166"></span>8166</td>
<td class="instruction">DEC DE</td>
<td class="comment-1" rowspan="1">Decrease the length counter</td>
</tr>
<tr>
<td class="address-1"><span id="8167"></span>8167</td>
<td class="instruction">INC IX</td>
<td class="comment-1" rowspan="1">Move to the next byte to be saved</td>
</tr>
<tr>
<td class="address-1"><span id="8169"></span>8169</td>
<td class="instruction">LD B,$31</td>
<td class="comment-1" rowspan="1">Set the timing constant for the first bit of the next byte</td>
</tr>
<tr>
<td class="address-1"><span id="816b"></span>816B</td>
<td class="instruction">LD A,$7F</td>
<td class="comment-1" rowspan="4">Return if the BREAK key is being pressed</td>
</tr>
<tr>
<td class="address-1"><span id="816d"></span>816D</td>
<td class="instruction">IN A,($FE)</td>
</tr>
<tr>
<td class="address-1"><span id="816f"></span>816F</td>
<td class="instruction">RRA</td>
</tr>
<tr>
<td class="address-1"><span id="8170"></span>8170</td>
<td class="instruction">RET NC</td>
</tr>
<tr>
<td class="address-1"><span id="8171"></span>8171</td>
<td class="instruction">LD A,D</td>
<td class="comment-1" rowspan="2">Have we saved 4000 to 80BB yet?</td>
</tr>
<tr>
<td class="address-1"><span id="8172"></span>8172</td>
<td class="instruction">INC A</td>
</tr>
<tr>
<td class="address-1"><span id="8173"></span>8173</td>
<td class="instruction">JP NZ,$813A</td>
<td class="comment-1" rowspan="1">Jump back if not</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="8176"></span>
<div class="comments">
<div class="paragraph">
Now a further 32892 bytes are saved: starting at 80D0, moving forward in steps of 247 bytes, rolling back to page 0x7F whenever the 64K boundary is hit, and ending at 817D.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="8176"></span>8176</td>
<td class="instruction">RET NZ</td>
<td class="comment-1" rowspan="1">This return does not happen</td>
</tr>
<tr>
<td class="address-1"><span id="8177"></span>8177</td>
<td class="instruction">LD DE,$807C</td>
<td class="comment-1" rowspan="1">We need to save a further 32892 bytes</td>
</tr>
<tr>
<td class="address-1"><span id="817a"></span>817A</td>
<td class="instruction">LD A,$31</td>
<td class="comment-1" rowspan="2">Change the instruction at 8086 (in the <a href="../load/802F.html">load routine</a>) to LD SP,$5D1B</td>
</tr>
<tr>
<td class="address-1"><span id="817c"></span>817C</td>
<td class="instruction">LD ($8086),A</td>
</tr>
<tr>
<td class="address-1"><span id="817f"></span>817F</td>
<td class="instruction">LD B,$2E</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-2"><span id="8181"></span>8181</td>
<td class="instruction">LD A,D</td>
<td class="comment-1" rowspan="2">Have we saved every byte of the second section yet?</td>
</tr>
<tr>
<td class="address-1"><span id="8182"></span>8182</td>
<td class="instruction">OR E</td>
</tr>
<tr>
<td class="address-1"><span id="8183"></span>8183</td>
<td class="instruction">JR Z,$8191</td>
<td class="comment-1" rowspan="1">Jump if so</td>
</tr>
<tr>
<td class="address-1"><span id="8185"></span>8185</td>
<td class="instruction">LD L,(IX+$14)</td>
<td class="comment-1" rowspan="1">Otherwise pick up the next byte to save</td>
</tr>
<tr>
<td class="address-1"><span id="8188"></span>8188</td>
<td class="instruction">LD A,H</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=current parity byte</td>
</tr>
<tr>
<td class="address-1"><span id="8189"></span>8189</td>
<td class="instruction">XOR L</td>
<td class="comment-1" rowspan="1">Update this for the next byte to be saved</td>
</tr>
<tr>
<td class="address-1"><span id="818a"></span>818A</td>
<td class="instruction">LD H,A</td>
<td class="comment-1" rowspan="1"><span class="register">H</span>=new parity byte</td>
</tr>
<tr>
<td class="address-1"><span id="818b"></span>818B</td>
<td class="instruction">LD A,$01</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=0x01 (MIC on, border blue)</td>
</tr>
<tr>
<td class="address-1"><span id="818d"></span>818D</td>
<td class="instruction">SCF</td>
<td class="comment-1" rowspan="1">Set the carry flag (which will act as the marker bit)</td>
</tr>
<tr>
<td class="address-1"><span id="818e"></span>818E</td>
<td class="instruction">JP $81A8</td>
<td class="comment-1" rowspan="1">Jump forward to save the byte</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="8191"></span>
<div class="comments">
<div class="paragraph">
This is where we come when all 49464 bytes have been saved.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="8191"></span>8191</td>
<td class="instruction">LD L,$00</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="8193"></span>8193</td>
<td class="instruction">RET</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="8194"></span>
<div class="comments">
<div class="paragraph">
This is the bit-saving loop for the second section of data.
</div>
</div>
</td>
</tr>
<tr>
<td class="address-2"><span id="8194"></span>8194</td>
<td class="instruction">LD A,C</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=0x0E (MIC off, border yellow) for the second pass</td>
</tr>
<tr>
<td class="address-1"><span id="8195"></span>8195</td>
<td class="instruction">BIT 7,B</td>
<td class="comment-1" rowspan="1">Set the zero flag to indicate that this is the second pass through the loop</td>
</tr>
<tr>
<td class="address-2"><span id="8197"></span>8197</td>
<td class="instruction">DJNZ $8197</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="8199"></span>8199</td>
<td class="instruction">JR NC,$819F</td>
<td class="comment-1" rowspan="1">Jump if we are saving a '0'</td>
</tr>
<tr>
<td class="address-1"><span id="819b"></span>819B</td>
<td class="instruction">LD B,$42</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-2"><span id="819d"></span>819D</td>
<td class="instruction">DJNZ $819D</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-2"><span id="819f"></span>819F</td>
<td class="instruction">OUT ($FE),A</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="81a1"></span>81A1</td>
<td class="instruction">LD B,$3E</td>
<td class="comment-1" rowspan="1">Set the timing constant for the second pass</td>
</tr>
<tr>
<td class="address-1"><span id="81a3"></span>81A3</td>
<td class="instruction">JR NZ,$8194</td>
<td class="comment-1" rowspan="1">Jump back for the second pass if we've just done the first</td>
</tr>
<tr>
<td class="address-1"><span id="81a5"></span>81A5</td>
<td class="instruction">DEC B</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="81a6"></span>81A6</td>
<td class="instruction">XOR A</td>
<td class="comment-1" rowspan="1">Clear the carry flag</td>
</tr>
<tr>
<td class="address-1"><span id="81a7"></span>81A7</td>
<td class="instruction">INC A</td>
<td class="comment-1" rowspan="1"><span class="register">A</span>=0x01 (MIC on, border blue)</td>
</tr>
<tr>
<td class="address-2"><span id="81a8"></span>81A8</td>
<td class="instruction">RL L</td>
<td class="comment-1" rowspan="1">Move the bit to be saved into the carry flag, and the marker bit leftwards</td>
</tr>
<tr>
<td class="address-1"><span id="81aa"></span>81AA</td>
<td class="instruction">JP NZ,$8197</td>
<td class="comment-1" rowspan="1">Jump unless we've saved all 8 bits of the byte</td>
</tr>
<tr>
<td class="routine-comment" colspan="5">
<span id="81ad"></span>
<div class="comments">
<div class="paragraph">
A byte from the second section has just been saved. Are there any more left?
</div>
</div>
</td>
</tr>
<tr>
<td class="address-1"><span id="81ad"></span>81AD</td>
<td class="instruction">DEC DE</td>
<td class="comment-1" rowspan="1">Decrease the length counter</td>
</tr>
<tr>
<td class="address-1"><span id="81ae"></span>81AE</td>
<td class="instruction">EXX</td>
<td class="comment-1" rowspan="3">Move forward 247 bytes to the next byte to be saved</td>
</tr>
<tr>
<td class="address-1"><span id="81af"></span>81AF</td>
<td class="instruction">ADD IX,BC</td>
</tr>
<tr>
<td class="address-1"><span id="81b1"></span>81B1</td>
<td class="instruction">EXX</td>
</tr>
<tr>
<td class="address-1"><span id="81b2"></span>81B2</td>
<td class="instruction">LD B,$2F</td>
<td class="comment-1" rowspan="1">Set the timing constant for the first bit of the next byte</td>
</tr>
<tr>
<td class="address-1"><span id="81b4"></span>81B4</td>
<td class="instruction">JR NC,$81B8</td>
<td class="comment-1" rowspan="1">Jump unless <span class="register">IX</span> was incremented beyond the 64K boundary</td>
</tr>
<tr>
<td class="address-1"><span id="81b6"></span>81B6</td>
<td class="instruction">LD IXh,$7F</td>
<td class="comment-1" rowspan="1">Reset the high byte of the <span class="register">IX</span> register</td>
</tr>
<tr>
<td class="address-1"><span id="81b9"></span>81B9</td>
<td class="instruction">LD A,$7F</td>
<td class="comment-1" rowspan="3">These instructions check the BREAK key but do not act on the result</td>
</tr>
<tr>
<td class="address-1"><span id="81bb"></span>81BB</td>
<td class="instruction">IN A,($FE)</td>
</tr>
<tr>
<td class="address-1"><span id="81bd"></span>81BD</td>
<td class="instruction">RRA</td>
</tr>
<tr>
<td class="address-1"><span id="81be"></span>81BE</td>
<td class="instruction">NOP</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="81bf"></span>81BF</td>
<td class="instruction">NOP</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="81c0"></span>81C0</td>
<td class="instruction">NOP</td>
<td class="comment-1" rowspan="1"></td>
</tr>
<tr>
<td class="address-1"><span id="81c1"></span>81C1</td>
<td class="instruction">JP $8181</td>
<td class="comment-1" rowspan="1">Save the next byte</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev">
</td>
<td class="up">Up: <a href="save.html#80f2">Map</a></td>
<td class="next">
</td>
</tr>
</table>
<footer>
<div class="release">The complete Contact Sam Cruise RAM disassembly 20191116</div>
<div class="copyright">&#169; 1986 Microsphere Computer Services Ltd. &#169; 2019 Richard Dymond.</div>
<div class="created">Created using <a href="https://skoolkit.ca">SkoolKit</a> 8.0.</div>
<div><a href="../dec/save/33010.html">Switch to decimal</a>.</div>
</footer>
</body>
</html>